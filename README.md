# hashibuild
Hash initiated build. Avoid recompiling artifacts when source tree hash hasn't changed.

The basic idea is that your build artifacts in "outputDir" are a direct function of a set of your source files. We perform a deep tree checksum of your source tree and zip up the output directory with the name derived from the checksum.

So we:

1. Count the hash for the input files (sources, yarn.lock etc)
2. If a zip file corresponding with the hash is found in the "archive" directory, we just unzip that zip file to output directory.
3. If a zip file is not found, we run the build command ('buildCmd' value) in the 'inputRoot' directory and create the zip file from the new artifacts
4. On next run, the build will be skipped since we can use the zip file generated by phase #3.


## Installation

```
$ zippim get https://github.com/vivainio/hashibuild/releases/download/v0.1/hashibuild.exe
```

Or just drop the file to PATH.

## Usage

```
Î» hashibuild -h
Usage of C:\PKG\bin\hashibuild.exe:
  -archive string
        Archive root dir (needed if HASHIBUILD_ARCHIVE env var is not set)
  -build
        Run build
  -config string
        Json config file
  -manifest
        Show manifest (requires --config)
  -treehash string
        Show manifest for specified path (no config needed)
```

Example configuration file:

```
{
    "name": "myapp",
    "inputRoot": "../../myapp",
    "inputPaths": ["src", "yarn.lock"],
    "outputDir": "../../myapp/published",
    "buildCmd": ".\\Build.cmd",
    "ignores": ["src/Tests", "src/templates.ts"]
}
```

